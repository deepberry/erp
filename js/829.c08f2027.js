"use strict";(self["webpackChunktitan2"]=self["webpackChunktitan2"]||[]).push([[829],{7829:function(e,t,a){a.r(t),a.d(t,{default:function(){return _}});var n=a(6252),i=a(3577);const s={class:"role"},o={class:"group"},r=["onClick"],l={class:"content"};function d(e,t){const a=(0,n.up)("AccountRoleErp"),d=(0,n.up)("el-tab-pane"),u=(0,n.up)("AccountRoleDevice"),c=(0,n.up)("el-tabs");return(0,n.wg)(),(0,n.iD)("div",s,[(0,n._)("div",o,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.groupList,((t,a)=>((0,n.wg)(),(0,n.iD)("p",{onClick:t=>e.groupClick(a),class:(0,i.C_)({active:a==e.currentGroupIndex}),key:t.id},(0,i.zw)(t.name),11,r)))),128))]),(0,n._)("div",l,[(0,n.Wm)(c,{modelValue:e.activeTab,"onUpdate:modelValue":t[0]||(t[0]=t=>e.activeTab=t),onTabClick:e.tabClick},{default:(0,n.w5)((()=>[(0,n.Wm)(d,{label:"ERP模块权限",name:"erp"},{default:(0,n.w5)((()=>[(0,n.Wm)(a,{id:e.currentGroupIndex},null,8,["id"])])),_:1}),(0,n.Wm)(d,{label:"设备及其他权限",name:"device"},{default:(0,n.w5)((()=>[(0,n.Wm)(u)])),_:1})])),_:1},8,["modelValue","onTabClick"])])])}const u={class:"roleErp"},c={class:"box"},p={class:"btn"},m=(0,n.Uk)("保存");function h(e,t,a,i,s,o){const r=(0,n.up)("el-tree"),l=(0,n.up)("el-button"),d=(0,n.Q2)("loading");return(0,n.wy)(((0,n.wg)(),(0,n.iD)("div",u,[(0,n._)("div",c,[(0,n.Wm)(r,{props:s.props,ref:"tree",data:s.list,"node-key":"id","default-expand-all":"","default-checked-keys":s.showList,"show-checkbox":""},null,8,["props","data","default-checked-keys"])]),(0,n._)("div",p,[(0,n.Wm)(l,{type:"primary",onClick:o.save,loading:s.saving},{default:(0,n.w5)((()=>[m])),_:1},8,["onClick","loading"])])])),[[d,s.loading]])}var v={name:"roleErp",props:["id"],watch:{id(e){this.roleId=e,this.init(this)}},data(){return{roleId:0,props:{label:"name",children:"menuParentBoList"},list:[],loading:!1,showList:[],saving:!1}},mounted(){this.init(this)},methods:{init:async function(e){e.loading=!0,e.list=[],e.showList=[];let t=await e.getList(),a=await e.getUserRole(),n=[];t=t.map((e=>(a.map((t=>{e.id==t.id&&e.menuParentBoList.map((e=>{t.menuParentBoList.map((t=>{e.id==t.id&&e.menuParentBoList.map((e=>{t.menuParentBoList.map((t=>{e.id==t.id&&n.push(e.id)}))}))}))}))})),e))),e.list=t,e.showList=n,e.loading=!1},getList(){return new Promise(((e,t)=>{this.ajax.post("/api/v1/adam/adminMenu/getMenuList").then((t=>{let a=t.data.map((e=>(e.menuParentBoList=e.menuParentBoList.map((e=>(e.menuParentBoList=e.menuBoList,e))),e)));e(a)}))}))},getUserRole(){return new Promise(((e,t)=>{this.ajax.post("/api/v1/adam/adminMenu/getUserMenuList",{roleId:this.roleId}).then((t=>{let a=t.data.map((e=>(e.menuParentBoList=e.menuParentBoList.map((e=>(e.menuParentBoList=e.menuBoList,e))),e)));e(a)}))}))},save(){this.saving=!0,this.ajax.post("/api/v1/adam/adminMenu/saveUserMenu",{menuIds:this.$refs.tree.getCheckedKeys().join(","),roleId:this.roleId}).then((e=>{this.saving=!1,this.$message.success("保存成功")}))}}},g=a(8118);const L=(0,g.Z)(v,[["render",h],["__scopeId","data-v-4e017876"]]);var k=L;const w={class:"roleErp"};function b(e,t,a,i,s,o){const r=(0,n.up)("el-tree");return(0,n.wg)(),(0,n.iD)("div",w,[(0,n.Wm)(r,{props:s.props,data:s.list,"show-checkbox":""},null,8,["props","data"])])}var f={name:"roleErp",data(){return{props:{label:"name",children:"menuParentBoList"},list:[],role:[]}}};const P=(0,g.Z)(f,[["render",b]]);var B=P,C={name:"role",components:{AccountRoleErp:k,AccountRoleDevice:B},data(){return{groupList:[{name:"管理员",id:1},{name:"普通用户",id:2}],currentGroupIndex:0,activeTab:"erp",userList:[]}},methods:{groupClick(e){this.currentGroupIndex=e},tabClick(e){}}};const I=(0,g.Z)(C,[["render",d],["__scopeId","data-v-20ddb974"]]);var _=I}}]);
//# sourceMappingURL=829.c08f2027.js.map