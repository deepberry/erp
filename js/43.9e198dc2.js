"use strict";(self["webpackChunktitan2"]=self["webpackChunktitan2"]||[]).push([[43],{8043:function(e,t,s){s.r(t),s.d(t,{default:function(){return R}});var i=s(6252),l=s(3577);const a=e=>((0,i.dD)("data-v-3bcaebee"),e=e(),(0,i.Cn)(),e),o={class:"stockPut inner"},n={class:"box"},r={class:"head"},u=a((()=>(0,i._)("i",{class:"erp erpfanhui",style:{"font-size":"14px","margin-right":"5px",position:"relative",top:"-1px"}},null,-1))),h=(0,i.Uk)(" 返回"),c=a((()=>(0,i._)("span",{style:{position:"relative",top:"2px","font-size":"15px"}},"发起申领",-1))),m={class:"content"},p=a((()=>(0,i._)("i",{style:{"font-size":"14px","margin-right":"5px"},class:"erp erpicon_tianjia"},null,-1))),d=(0,i.Uk)(" 添加 "),g={class:"title"},w={class:"tagBox"},y={class:"tag"},k={class:"unit"},C={class:"num"},b=a((()=>(0,i._)("p",null,"出库数量：",-1))),_={class:"step"},x=a((()=>(0,i._)("p",{class:"title"},"审核流程",-1))),v={class:"stepList"},f=a((()=>(0,i._)("i",{class:"erp erpxiangyou1"},null,-1))),$=a((()=>(0,i._)("i",{class:"erp erpicon_tianjia"},null,-1))),D=(0,i.Uk)("提交");function z(e,t){const s=(0,i.up)("el-button"),a=(0,i.up)("el-input"),z=(0,i.up)("el-tag"),B=(0,i.up)("el-option"),S=(0,i.up)("el-select"),U=(0,i.up)("MyStartChose");return(0,i.wg)(),(0,i.iD)("div",o,[(0,i._)("div",n,[(0,i._)("div",r,[(0,i.Wm)(s,{link:"",type:"primary",onClick:e.back},{default:(0,i.w5)((()=>[u,h])),_:1},8,["onClick"]),c]),(0,i._)("div",m,[(0,i.Wm)(s,{plain:"",type:"primary",style:{"margin-bottom":"20px"},onClick:t[0]||(t[0]=t=>e.showChose=!0)},{default:(0,i.w5)((()=>[p,d])),_:1}),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.list,((e,t)=>((0,i.wg)(),(0,i.iD)("div",{class:"item",key:t},[(0,i._)("p",g,(0,l.zw)(e.agriculturalBo.title),1),(0,i._)("p",w,[(0,i._)("span",y,(0,l.zw)(e.agriculturalBo.agriculturalCategory),1)]),(0,i._)("div",k,[(0,i._)("p",null,(0,l.zw)(e.agriculturalBo.manufacturers),1),(0,i._)("p",null," ("+(0,l.zw)(e.agriculturalBo.agriculturalCount)+(0,l.zw)(e.agriculturalBo.unitweight)+"/"+(0,l.zw)(e.agriculturalBo.unitmeasurement)+") ",1)]),(0,i._)("div",C,[b,(0,i.Wm)(a,{style:{width:"120px",margin:"0 10px"},modelValue:e.num,"onUpdate:modelValue":t=>e.num=t,placeholder:"请输入数量"},null,8,["modelValue","onUpdate:modelValue"]),(0,i._)("p",null,(0,l.zw)(e.agriculturalBo.unitweight),1)])])))),128)),(0,i._)("div",_,[x,(0,i._)("div",v,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.userChosed,((t,s)=>((0,i.wg)(),(0,i.iD)(i.HY,{key:s},[(0,i.Wm)(z,{closable:"",onClose:t=>e.delUser(s)},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.name),1)])),_:2},1032,["onClose"]),f],64)))),128)),e.showSelect?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(s,{key:0,type:"primary",style:{width:"28px"},plain:"",size:"small",onClick:t[1]||(t[1]=t=>e.showSelect=!0)},{default:(0,i.w5)((()=>[$])),_:1})),e.showSelect?((0,i.wg)(),(0,i.j4)(S,{key:1,onChange:e.select,modelValue:e.currentChose,"onUpdate:modelValue":t[2]||(t[2]=t=>e.currentChose=t),size:"small",style:{"margin-right":"10px"},placeholder:"请选择用户"},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.userlist,(e=>((0,i.wg)(),(0,i.j4)(B,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["onChange","modelValue"])):(0,i.kq)("",!0)])]),(0,i.Wm)(s,{type:"primary",style:{"margin-top":"20px"},onClick:e.submit,loading:e.submitting},{default:(0,i.w5)((()=>[D])),_:1},8,["onClick","loading"])])]),e.showChose?((0,i.wg)(),(0,i.j4)(U,{key:0,onOnClose:e.closeReg,onSubmit:e.chose},null,8,["onOnClose","onSubmit"])):(0,i.kq)("",!0)])}const B={class:"stockReg"},S={class:"box"},U={class:"search"},M=(0,i.Uk)("查询"),T={class:"list"},V=["onClick"],L={class:"tag"},N=(0,i.Uk)("确定选择");function W(e,t){const s=(0,i.up)("el-input"),a=(0,i.up)("el-button"),o=(0,i.up)("el-empty"),n=(0,i.up)("el-dialog"),r=(0,i.Q2)("loading");return(0,i.wg)(),(0,i.iD)("div",B,[(0,i.Wm)(n,{"custom-class":"stockRegBox","before-close":e.onClose,"append-to-body":"",modelValue:e.showBox,"onUpdate:modelValue":t[1]||(t[1]=t=>e.showBox=t),title:"选择农资",width:"500px"},{default:(0,i.w5)((()=>[(0,i.wy)(((0,i.wg)(),(0,i.iD)("div",S,[(0,i._)("div",U,[(0,i.Wm)(s,{style:{width:"390px"},modelValue:e.searchKey,"onUpdate:modelValue":t[0]||(t[0]=t=>e.searchKey=t),placeholder:"关键字搜索：农资名称、厂家名称"},null,8,["modelValue"]),(0,i.Wm)(a,{type:"primary",plain:"",onClick:e.getData},{default:(0,i.w5)((()=>[M])),_:1},8,["onClick"])]),(0,i._)("div",T,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.list,((t,s)=>((0,i.wg)(),(0,i.iD)("div",{class:"item",onClick:i=>e.chose(t,s),key:s},[(0,i._)("div",null,[(0,i._)("p",null,(0,l.zw)(t.agriculturalBo.title),1),(0,i._)("i",{class:(0,l.C_)(t.check?"erp erpduoxuankuangxuanzhong":"erp erpduoxuan-01")},null,2)]),(0,i._)("div",null,[(0,i._)("p",null,[(0,i._)("span",L,(0,l.zw)(t.agriculturalBo.agriculturalCategory),1)])]),(0,i._)("div",null,[(0,i._)("p",null,(0,l.zw)(t.agriculturalBo.manufacturers),1),(0,i._)("p",null," ("+(0,l.zw)(t.agriculturalBo.agriculturalCount)+(0,l.zw)(t.agriculturalBo.unitweight)+"/"+(0,l.zw)(t.agriculturalBo.unitmeasurement)+") ",1)])],8,V)))),128)),0==e.list.length?((0,i.wg)(),(0,i.j4)(o,{key:0,description:"暂无数据"})):(0,i.kq)("",!0)]),(0,i.Wm)(a,{onClick:e.submit,type:"primary",style:{width:"calc(100% - 40px)",margin:"20px"}},{default:(0,i.w5)((()=>[N])),_:1},8,["onClick"])])),[[r,e.loading]])])),_:1},8,["before-close","modelValue"])])}var j={name:"myStartChose",data(){return{loading:!1,searchKey:"",list:[],showBox:!0,chosed:[]}},mounted(){this.getData()},methods:{getData(){this.loading=!0,this.ajax.post("/api/v1/adam/farmLand/agriculturalSearch-list",{pageNum:1,pageSize:10,param:{categoryId:0,inventory:0,keyWord:this.searchKey}}).then((e=>{this.list=e.data.map((e=>(e.check=!1,e))),this.loading=!1}))},onClose(){this.$emit("onClose",0),this.showBox=!1},chose(e,t){this.list[t].check=!this.list[t].check,this.chosed.push(e)},submit(){this.$emit("submit",this.chosed),this.onClose()}}},I=s(8118);const K=(0,I.Z)(j,[["render",W],["__scopeId","data-v-0981087c"]]);var H=K,O=(s(2335),{name:"stockPut",props:["id"],data(){return{list:[],userlist:[],userChosed:[],currentChose:"",showSelect:!1,note:"",showChose:!1,input:"",submitting:!1}},mounted(){this.getUserlist(),this.getStep()},components:{MyStartChose:H},methods:{getUserlist(){this.ajax.post("/api/v1/adam/task/getOrganizationUsers").then((e=>{this.userlist=e.data}))},getStep(){this.ajax.post("/api/v1/adam/workOrder/getManager-list").then((e=>{this.userChosed=e.data.map((e=>(e.name=e.username,e)))}))},back(){this.$router.push("/erp/my/product")},closeReg(){let e=setTimeout((()=>{this.showChose=!1,clearTimeout(e)}),500)},chose(e){this.list=[...this.list,...e]},select(e){this.userlist.map((t=>{t.id==e&&this.userChosed.push(t)})),this.currentChose="",this.showSelect=!1},delUser(e){console.log(e),this.userChosed.splice(e,1)},submit(){if(0==this.list.length)return void this.$message.warning("请选择农资");if(0==this.userChosed.length)return void this.$message.warning("请选择审核人");let e=this.userChosed.map((e=>({aid:e.id,username:e.name}))),t=this.list.map((e=>({agriculturalId:e.agriculturalBo.id,id:e.id,orderCount:e.num})));console.log(t);let s=!1;t.map((e=>{e.orderCount||(s=!0)})),s?this.$message.warning("请输入农资数量"):(this.submitting=!0,this.ajax.post("/api/v1/adam/workOrder/saveWorkOrder",{orderManagerBoList:e,orderWorkBoList:t}).then((e=>{if(this.submitting=!1,200==e.code){this.$message.success("提交成功！");let e=setTimeout((()=>{this.$router.push("/erp/my/product"),clearTimeout(e)}),500)}else this.$message.error(e.message)})))}}});const Y=(0,I.Z)(O,[["render",z],["__scopeId","data-v-3bcaebee"]]);var R=Y},2335:function(e,t){const s={to2:e=>Number(e)<10?`0${Number(e)}`:String(e),time(e="y-m-d",t=null){let s=t?new Date(t):new Date;return e=e.replace("y",s.getFullYear()),e=e.replace("m",this.to2(s.getMonth()+1)),e=e.replace("d",this.to2(s.getDate())),e=e.replace("h",this.to2(s.getHours())),e=e.replace("i",this.to2(s.getMinutes())),e=e.replace("s",this.to2(s.getSeconds())),e=e.replace("w",s.getDay()),e},monthLength(e=null){let t=1*this.time("y",e),s=this.to2(1*this.time("m",e)+1);if(13==s)return 31;{let e=new Date(`${t}-${s}-01`).getTime()-864e5;return Number(this.time("d",e))}},preMonthLenggth(e=null){let t=1*this.time("y",e),s=this.to2(1*this.time("m",e)),i=new Date(`${t}-${s}-01`).getTime()-864e5;return Number(this.time("d",i))},nextMonthLenggth(e=null){let t=1*this.time("y",e),s=this.to2(1*this.time("m",e)+2),i=new Date(`${t}-${s}-01`).getTime()-864e5;return Number(this.time("d",i))},monthFirst(e=null){let t=this.time("y-m",e)+"-01";return this.time("y-m-d",t)},monthLast(e=null){let t=1*this.time("y",e),s=this.to2(1*this.time("m",e)+1),i=new Date(`${t}-${s}-01`).getTime()-864e5;return this.time("y-m-d",i)},preMonthToday(e=null){let t=Number(e.substr(0,4)),s=Number(e.substr(5,2)),i=Number(e.substr(8));return i>this.preMonthLenggth(`{y}-${s}-01`)&&(i=this.preMonthLenggth(`{y}-${s}-01`)),1==s?(t-=1,s=12):s-=1,`${t}-${s}-${i}`},nextMonthToday(e=null){let t=Number(e.substr(0,4)),s=Number(e.substr(5,2)),i=Number(e.substr(8));return i>this.nextMonthLenggth(`{y}-${s}-01`)&&(i=this.nextMonthLenggth(`{y}-${s}-01`)),12==s?(t+=1,s=1):s+=1,`${t}-${s}-${i}`},timeout(e){},timeRemaining(e,t){return t-=parseInt((new Date).getTime()/1e3),this.unixToString(e,t)},unixToString(e,t){let i=parseInt(t/60/60/24),l=parseInt((t-86400*i)/3600),a=parseInt((t-86400*i-3600*l)/60),o=t-86400*i-3600*l-60*a;return e=e.replace("d",s.to2(s.low(i))),e=e.replace("h",s.to2(s.low(l))),e=e.replace("i",s.to2(s.low(a))),e=e.replace("s",s.to2(s.low(o))),e},low(e){return e<0?0:e},parse(e){return new Date(e)}};t["Z"]=s}}]);
//# sourceMappingURL=43.9e198dc2.js.map