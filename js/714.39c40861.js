"use strict";(self["webpackChunktitan2"]=self["webpackChunktitan2"]||[]).push([[714],{5714:function(e,t,l){l.r(t),l.d(t,{default:function(){return Z}});var s=l(6252),i=l(3577);const a=e=>((0,s.dD)("data-v-3e0ea8cb"),e=e(),(0,s.Cn)(),e),r={class:"stockPut inner"},n={class:"box"},o={class:"head"},u=a((()=>(0,s._)("i",{class:"erp erpfanhui",style:{"font-size":"14px","margin-right":"5px",position:"relative",top:"-1px"}},null,-1))),h=(0,s.Uk)(" 返回"),c=a((()=>(0,s._)("span",{style:{position:"relative",top:"2px","font-size":"15px"}},"发起申领",-1))),m={class:"content"},p=a((()=>(0,s._)("i",{style:{"font-size":"14px","margin-right":"5px"},class:"erp erpicon_tianjia"},null,-1))),g=(0,s.Uk)(" 添加 "),d={class:"title"},w={class:"unit",style:{padding:"20px 0"}},y={class:"tag"},k={style:{color:"#409eff"}},C={class:"unit"},_={class:"num"},b=a((()=>(0,s._)("p",null,"出库数量：",-1))),x={class:"step"},v=a((()=>(0,s._)("p",{class:"title"},"审核流程",-1))),f={class:"stepList"},z=a((()=>(0,s._)("i",{class:"erp erpxiangyou1"},null,-1))),$=a((()=>(0,s._)("i",{class:"erp erpicon_tianjia"},null,-1))),B=(0,s.Uk)("提交");function D(e,t){const l=(0,s.up)("el-button"),a=(0,s.up)("el-input"),D=(0,s.up)("el-tag"),S=(0,s.up)("el-option"),U=(0,s.up)("el-select"),M=(0,s.up)("MyStartChose");return(0,s.wg)(),(0,s.iD)("div",r,[(0,s._)("div",n,[(0,s._)("div",o,[(0,s.Wm)(l,{link:"",type:"primary",onClick:e.back},{default:(0,s.w5)((()=>[u,h])),_:1},8,["onClick"]),c]),(0,s._)("div",m,[(0,s.Wm)(l,{plain:"",type:"primary",style:{"margin-bottom":"20px"},onClick:t[0]||(t[0]=t=>e.showChose=!0)},{default:(0,s.w5)((()=>[p,g])),_:1}),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.list,((e,t)=>((0,s.wg)(),(0,s.iD)("div",{class:"item",key:t},[(0,s._)("p",d,(0,i.zw)(e.agriculturalBo.title),1),(0,s._)("div",w,[(0,s._)("p",null,[(0,s._)("span",y,(0,i.zw)(e.agriculturalBo.agriculturalCategory),1)]),(0,s._)("p",k," 库存量："+(0,i.zw)(e.agriculturalUnit)+(0,i.zw)(e.agriculturalBo.unitmeasurement)+"共"+(0,i.zw)(e.agriculturalCount)+(0,i.zw)(e.agriculturalBo.unitweight),1)]),(0,s._)("div",C,[(0,s._)("p",null,(0,i.zw)(e.agriculturalBo.manufacturers),1),(0,s._)("p",null," ("+(0,i.zw)(e.agriculturalBo.agriculturalCount)+(0,i.zw)(e.agriculturalBo.unitweight)+"/"+(0,i.zw)(e.agriculturalBo.unitmeasurement)+") ",1)]),(0,s._)("div",_,[b,(0,s.Wm)(a,{style:{width:"120px",margin:"0 10px"},modelValue:e.num,"onUpdate:modelValue":t=>e.num=t,placeholder:"请输入数量"},null,8,["modelValue","onUpdate:modelValue"]),(0,s._)("p",null,(0,i.zw)(e.agriculturalBo.unitweight),1)])])))),128)),(0,s._)("div",x,[v,(0,s._)("div",f,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.userChosed,((t,l)=>((0,s.wg)(),(0,s.iD)(s.HY,{key:l},[(0,s.Wm)(D,{closable:"",onClose:t=>e.delUser(l)},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(t.name),1)])),_:2},1032,["onClose"]),z],64)))),128)),e.showSelect?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(l,{key:0,type:"primary",style:{width:"28px"},plain:"",size:"small",onClick:t[1]||(t[1]=t=>e.showSelect=!0)},{default:(0,s.w5)((()=>[$])),_:1})),e.showSelect?((0,s.wg)(),(0,s.j4)(U,{key:1,onChange:e.select,modelValue:e.currentChose,"onUpdate:modelValue":t[2]||(t[2]=t=>e.currentChose=t),size:"small",style:{"margin-right":"10px"},placeholder:"请选择用户"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.userlist,(e=>((0,s.wg)(),(0,s.j4)(S,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["onChange","modelValue"])):(0,s.kq)("",!0)])]),(0,s.Wm)(l,{type:"primary",style:{"margin-top":"20px"},onClick:e.submit,loading:e.submitting},{default:(0,s.w5)((()=>[B])),_:1},8,["onClick","loading"])])]),e.showChose?((0,s.wg)(),(0,s.j4)(M,{key:0,onOnClose:e.closeReg,onSubmit:e.chose},null,8,["onOnClose","onSubmit"])):(0,s.kq)("",!0)])}const S={class:"stockReg"},U={class:"box"},M={class:"search"},T=(0,s.Uk)("查询"),V={class:"list"},L=["onClick"],N={class:"tag"},W={style:{color:"#409eff"}},j=(0,s.Uk)("确定选择");function I(e,t){const l=(0,s.up)("el-input"),a=(0,s.up)("el-button"),r=(0,s.up)("el-empty"),n=(0,s.up)("el-dialog"),o=(0,s.Q2)("loading");return(0,s.wg)(),(0,s.iD)("div",S,[(0,s.Wm)(n,{"custom-class":"stockRegBox","before-close":e.onClose,"append-to-body":"",modelValue:e.showBox,"onUpdate:modelValue":t[1]||(t[1]=t=>e.showBox=t),title:"选择农资",width:"500px"},{default:(0,s.w5)((()=>[(0,s.wy)(((0,s.wg)(),(0,s.iD)("div",U,[(0,s._)("div",M,[(0,s.Wm)(l,{style:{width:"390px"},modelValue:e.searchKey,"onUpdate:modelValue":t[0]||(t[0]=t=>e.searchKey=t),placeholder:"关键字搜索：农资名称、厂家名称"},null,8,["modelValue"]),(0,s.Wm)(a,{type:"primary",plain:"",onClick:e.getData},{default:(0,s.w5)((()=>[T])),_:1},8,["onClick"])]),(0,s._)("div",V,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.list,((t,l)=>((0,s.wg)(),(0,s.iD)("div",{class:"item",onClick:s=>e.chose(t,l),key:l},[(0,s._)("div",null,[(0,s._)("p",null,(0,i.zw)(t.agriculturalBo.title),1),(0,s._)("i",{class:(0,i.C_)(t.check?"erp erpduoxuankuangxuanzhong":"erp erpduoxuan-01")},null,2)]),(0,s._)("div",null,[(0,s._)("p",null,[(0,s._)("span",N,(0,i.zw)(t.agriculturalBo.agriculturalCategory),1)]),(0,s._)("p",W," 库存量："+(0,i.zw)(t.agriculturalUnit)+(0,i.zw)(t.agriculturalBo.unitmeasurement)+"共"+(0,i.zw)(t.agriculturalCount)+(0,i.zw)(t.agriculturalBo.unitweight),1)]),(0,s._)("div",null,[(0,s._)("p",null,(0,i.zw)(t.agriculturalBo.manufacturers),1),(0,s._)("p",null," ("+(0,i.zw)(t.agriculturalBo.agriculturalCount)+(0,i.zw)(t.agriculturalBo.unitweight)+"/"+(0,i.zw)(t.agriculturalBo.unitmeasurement)+") ",1)])],8,L)))),128)),0==e.list.length?((0,s.wg)(),(0,s.j4)(r,{key:0,description:"暂无数据"})):(0,s.kq)("",!0)]),(0,s.Wm)(a,{onClick:e.submit,type:"primary",style:{width:"calc(100% - 40px)",margin:"20px"}},{default:(0,s.w5)((()=>[j])),_:1},8,["onClick"])])),[[o,e.loading]])])),_:1},8,["before-close","modelValue"])])}var K={name:"myStartChose",data(){return{loading:!1,searchKey:"",list:[],showBox:!0,chosed:[]}},mounted(){this.getData()},methods:{getData(){this.loading=!0,this.ajax.post("/api/v1/adam/farmLand/agriculturalSearch-list",{pageNum:1,pageSize:10,param:{categoryId:0,inventory:0,keyWord:this.searchKey}}).then((e=>{this.list=e.data.map((e=>(e.check=!1,e))),this.loading=!1}))},onClose(){this.$emit("onClose",0),this.showBox=!1},chose(e,t){this.list[t].check=!this.list[t].check,this.chosed.push(e)},submit(){this.$emit("submit",this.chosed),this.onClose()}}},H=l(8118);const O=(0,H.Z)(K,[["render",I],["__scopeId","data-v-06d3a9c3"]]);var Y=O,R=(l(2335),{name:"stockPut",props:["id"],data(){return{list:[],userlist:[],userChosed:[],currentChose:"",showSelect:!1,note:"",showChose:!1,input:"",submitting:!1}},mounted(){this.getUserlist(),this.getStep()},components:{MyStartChose:Y},methods:{getUserlist(){this.ajax.post("/api/v1/adam/task/getOrganizationUsers").then((e=>{this.userlist=e.data}))},getStep(){this.ajax.post("/api/v1/adam/workOrder/getManager-list").then((e=>{this.userChosed=e.data.map((e=>(e.name=e.username,e)))}))},back(){this.$router.push("/erp/my/product")},closeReg(){let e=setTimeout((()=>{this.showChose=!1,clearTimeout(e)}),500)},chose(e){this.list=[...this.list,...e]},select(e){this.userlist.map((t=>{t.id==e&&this.userChosed.push(t)})),this.currentChose="",this.showSelect=!1},delUser(e){console.log(e),this.userChosed.splice(e,1)},submit(){if(0==this.list.length)return void this.$message.warning("请选择农资");if(0==this.userChosed.length)return void this.$message.warning("请选择审核人");let e=this.userChosed.map((e=>({aid:e.id,username:e.name}))),t=this.list.map((e=>({agriculturalId:e.agriculturalBo.id,id:e.id,orderCount:e.num})));console.log(t);let l=!1;t.map((e=>{e.orderCount||(l=!0)})),l?this.$message.warning("请输入农资数量"):(this.submitting=!0,this.ajax.post("/api/v1/adam/workOrder/saveWorkOrder",{orderManagerBoList:e,orderWorkBoList:t}).then((e=>{if(this.submitting=!1,200==e.code){this.$message.success("提交成功！");let e=setTimeout((()=>{this.$router.push("/erp/my/product"),clearTimeout(e)}),500)}else this.$message.error(e.message)})))}}});const q=(0,H.Z)(R,[["render",D],["__scopeId","data-v-3e0ea8cb"]]);var Z=q},2335:function(e,t){const l={to2:e=>Number(e)<10?`0${Number(e)}`:String(e),time(e="y-m-d",t=null){let l=t?new Date(t):new Date;return e=e.replace("y",l.getFullYear()),e=e.replace("m",this.to2(l.getMonth()+1)),e=e.replace("d",this.to2(l.getDate())),e=e.replace("h",this.to2(l.getHours())),e=e.replace("i",this.to2(l.getMinutes())),e=e.replace("s",this.to2(l.getSeconds())),e=e.replace("w",l.getDay()),e},monthLength(e=null){let t=1*this.time("y",e),l=this.to2(1*this.time("m",e)+1);if(13==l)return 31;{let e=new Date(`${t}-${l}-01`).getTime()-864e5;return Number(this.time("d",e))}},preMonthLenggth(e=null){let t=1*this.time("y",e),l=this.to2(1*this.time("m",e)),s=new Date(`${t}-${l}-01`).getTime()-864e5;return Number(this.time("d",s))},nextMonthLenggth(e=null){let t=1*this.time("y",e),l=this.to2(1*this.time("m",e)+2),s=new Date(`${t}-${l}-01`).getTime()-864e5;return Number(this.time("d",s))},monthFirst(e=null){let t=this.time("y-m",e)+"-01";return this.time("y-m-d",t)},monthLast(e=null){let t=1*this.time("y",e),l=this.to2(1*this.time("m",e)+1),s=new Date(`${t}-${l}-01`).getTime()-864e5;return this.time("y-m-d",s)},preMonthToday(e=null){let t=Number(e.substr(0,4)),l=Number(e.substr(5,2)),s=Number(e.substr(8));return s>this.preMonthLenggth(`{y}-${l}-01`)&&(s=this.preMonthLenggth(`{y}-${l}-01`)),1==l?(t-=1,l=12):l-=1,`${t}-${l}-${s}`},nextMonthToday(e=null){let t=Number(e.substr(0,4)),l=Number(e.substr(5,2)),s=Number(e.substr(8));return s>this.nextMonthLenggth(`{y}-${l}-01`)&&(s=this.nextMonthLenggth(`{y}-${l}-01`)),12==l?(t+=1,l=1):l+=1,`${t}-${l}-${s}`},timeout(e){},timeRemaining(e,t){return t-=parseInt((new Date).getTime()/1e3),this.unixToString(e,t)},unixToString(e,t){let s=parseInt(t/60/60/24),i=parseInt((t-86400*s)/3600),a=parseInt((t-86400*s-3600*i)/60),r=t-86400*s-3600*i-60*a;return e=e.replace("d",l.to2(l.low(s))),e=e.replace("h",l.to2(l.low(i))),e=e.replace("i",l.to2(l.low(a))),e=e.replace("s",l.to2(l.low(r))),e},low(e){return e<0?0:e},parse(e){return new Date(e)}};t["Z"]=l}}]);
//# sourceMappingURL=714.39c40861.js.map